var j=null;
(function(e){function r(a){function b(){f();a.receiveMessage(l.onMessage,l.apiURL)}function f(){function a(){c=window.frames.stripeFrame;d()}var b=document.getElementsByTagName("body")[0],h=document.createElement("iframe");p=l.apiURL+"/js/v1/apitunnel.html";h.setAttribute("src",p+"#"+encodeURIComponent(window.location.href));h.setAttribute("name","stripeFrame");h.setAttribute("id","stripeFrame");h.setAttribute("frameborder","0");h.setAttribute("scrolling","no");h.setAttribute("allowtransparency","true");
h.setAttribute("width","0");h.setAttribute("height","0");h.attachEvent?h.attachEvent("onload",a):h.onload=a;b.appendChild(h)}function d(){if(c){var b=k.length;if(b>0){for(var d=0;d<b;++d){var h=k[d].message,q=h.id;g[q]=k[d].callback;a.postMessage(h,l.apiURL,p,c);i[q]=window.setTimeout(function(a){g[a](504,{error:{message:"There was an error processing your card"}});delete g[a];delete i[a]},6E4,q)}k=[]}}}if(typeof a==="undefined"){var a={},e=function(a){if(typeof a==="undefined"){var a={},b=function(){var a=
{};a.serialize=function(b,d){var c=[],n;for(n in b)if(b.hasOwnProperty(n)){var e=d?d+"["+n+"]":n,f=b[n];c.push(typeof f=="object"?a.serialize(f,e):encodeURIComponent(e)+"="+encodeURIComponent(f))}return c.join("&")};a.deserialize=function(a){for(var b={},a=a.split("&"),h=a.length,d=j,c=j,e=0;e<h;++e)if(c=a[e].split("="),c[0]=decodeURIComponent(c[0]),c[1]=decodeURIComponent(c[1]),d=c[0].match(/\[\w+\]/g),d===j)b[c[0]]=c[1];else{var f=c[0].substr(0,c[0].indexOf("["));typeof b[f]==="undefined"&&(b[f]=
{});for(var g=b[f],k=d.length,o=0;o<k-1;++o)f=d[o].substr(1,d[o].length-2),typeof g[f]==="undefined"&&(g[f]={}),g=g[f];d=d[k-1];f=d.substr(1,d.length-2);g[f]=c[1]}return b};return a};typeof a!=="undefined"?a=b():exports.createSerializer=b}return{postMessage:function(b,d,c,f){if(typeof window!=="undefined")b=a.serialize(b),typeof window.postMessage==="undefined"?f.location.href=c+"#"+ +new Date+Math.floor(Math.random()*1E3)+"&"+b:f.postMessage(b,d)},receiveMessage:function(b,d){if(typeof window!==
"undefined")if(window.postMessage)attachedCallback=function(c){if(c.origin!==d)return!1;b(a.deserialize(c.data))},window.addEventListener?window.addEventListener("message",attachedCallback,!1):window.attachEvent("onmessage",attachedCallback);else{var c=window.location.hash;setInterval(function(){var d=window.location.hash,f=/^#?\d+&/;if(d!==c&&f.test(d))c=d,window.location.hash="",b(a.deserialize(d.replace(f,"")))},100)}}}};typeof a!=="undefined"?a=e():exports.createXD=e}var c=j,k=[],t=0,g={},i={},
m=!1,p,l={apiURL:"https://api.stripe.com",onMessage:function(a){var b=a.id,d=j,d=a.response===j||a.response===""?{error:{message:"There was an error processing your card"}}:JSON.parse(a.response);g[b](parseInt(a.status),d);window.clearTimeout(i[b]);delete g[b];delete i[b]},init:function(){m||(typeof document!=="undefined"&&document&&document.body?b():typeof window!=="undefined"&&window&&(window.addEventListener?window.addEventListener("load",b,!1):window.attachEvent&&window.attachEvent("onload",b)),
m=!0)}};l.callAPI=function(a,b,c,f,e){if(a!=="POST"&&a!=="GET"&&a!=="DELETE")throw"You can only call the API with POST, GET or DELETE";l.init();var g=(t++).toString();k.push({message:{id:g,method:a,url:"/v1/"+b,params:c,key:f},callback:e});d()};return l}function m(a){return a.replace(/^\s+|\s+$/g,"")}function s(){if(!e.publishableKey)throw"No Publishable API Key: Call Stripe.setPublishableKey to provide your key.";}var c=j,i={};typeof window!=="undefined"&&!window.JSON&&(window.JSON={});(function(){if(typeof JSON.parse!==
"function")JSON.parse=function(a,b){function c(a,d){var e,i,g=a[d];if(g&&typeof g==="object")for(e in g)Object.hasOwnProperty.call(g,e)&&(i=c(g,e),i!==void 0?g[e]=i:delete g[e]);return b.call(a,d,g)}var d=RegExp("[\\u0000\\u00ad\\u0600-\\u0604\\u070f\\u17b4\\u17b5\\u200c-\\u200f\\u2028-\\u202f\\u2060-\\u206f\\ufeff\\ufff0-\\uffff]","g"),a=String(a);d.lastIndex=0;d.test(a)&&(a=a.replace(d,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)}));if(/^[\],:{}\s]*$/.test(a.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,
"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return d=eval("("+a+")"),typeof b==="function"?c({"":d},""):d;throw new SyntaxError("JSON.parse");}})();typeof i!=="undefined"?i=r():exports.createTransport=r;e.transport=i;e.validateCardNumber=function(a){var a=a.replace(/\s+|-/g,""),b;if(b=a.length>=10)if(b=a.length<=16)if(a.match(/^[0-9]+$/)===j)b=!1;else{var a=a.split("").reverse().join(""),c=0,d;for(b=0;b<a.length;++b)d=parseInt(a.charAt(b),
10),b%2!=0&&(d*=2),c+=d<10?d:d-9;b=c!=0&&c%10==0}return b};e.cardType=function(a){if(!c){c={};for(var b=40;b<=49;++b)c[b]="Visa";for(b=51;b<=55;++b)c[b]="Visa";c[34]=c[37]="American Express";c[60]=c[62]=c[64]=c[65]="Discover";c[35]="JCB";c[30]=c[36]="Diners Club"}a=c[a.substr(0,2)];return typeof a==="undefined"?"Unknown":a};e.validateCVC=function(a){a=m(a);return a.match(/^[0-9]+$/)!==j&&a.length>=3&&a.length<=4};e.validateExpiry=function(a,b){var a=m(a),b=m(b),c=new Date;return a.match(/^[0-9]+$/)!==
j&&b.match(/^[0-9]+$/)!==j&&b>c.getFullYear()||b==c.getFullYear()&&a>=c.getMonth()+1};e.createToken=function(a,b,c){typeof b==="function"&&(c=b,b=0);s();var d={expMonth:"exp_month",expYear:"exp_year",addressLine1:"address_line_1",addressLine2:"address_line_2",addressZip:"address_zip",addressState:"address_state",addressCountry:"address_country"};for(convertibleParam in d)d.hasOwnProperty(convertibleParam)&&a.hasOwnProperty(convertibleParam)&&(a[d[convertibleParam]]=a[convertibleParam],delete a[convertibleParam]);
e.transport.callAPI("POST","tokens",{card:a,amount:b},e.publishableKey,c)};e.getToken=function(a,b){s();e.transport.callAPI("GET","tokens/"+a,{},e.publishableKey,b)};e.setPublishableKey=function(a){e.publishableKey=a};i.init()})(typeof exports!=="undefined"&&exports!==j?exports:window.Stripe={});
